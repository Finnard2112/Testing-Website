<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>VNPT Services</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/css/bootstrap.min.css'>
    <link rel='stylesheet' href='https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css'>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js'></script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min.js'></script>
    <link rel='stylesheet' href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>
    <link rel="stylesheet" href="{{ url_for('static', filename='CSS/style.css') }}">
    <link href="{{ url_for('static', filename='css/style.scss.css') }}"
      rel="stylesheet" type="text/css">
    <script>
        function start_service(service_name) {
        console.log(service_name)
        // var url = "{{(api_urls | safe)}}";
        console.log("{{api_urls["iBeta"]}}")
        var xhr = new XMLHttpRequest();
        xhr.open("POST", url, true);
        xhr.onload = function () {
            const response = JSON.parse(this.responseText);
            console.log("I RAN")
            console.log(response.message)
            if (response.message == "success") {
                session_ids[service_name] = response.session_id;
                const elem = document.getElementById(element_id);
                elem.style.backgroundColor = "lightgreen";
            } else {
                alert("Unable to start iBeta")
            }
            }
        }

        $(document).ready(function () {
            var play_btn = $('.play_button')
            play_btn.click(function() {
                $(this).toggleClass('paused')
                start_service($(this).attr("id"))
                return false
            })
            var stop_btn 


            toastr.options = {
                "tapToDismiss": true,
                "closeButton": true,
                "debug": false,
                "positionClass": "toast-bottom-right",
                "onclick": null,
                "showDuration": "1000",
                "hideDuration": "1000",
                "timeOut": "300000",
                "extendedTimeOut": "1000",
                "showEasing": "swing",
                "hideEasing": "linear",
                "showMethod": "fadeIn",
                "hideMethod": "fadeOut",
                "preventDuplicates": true
            }

            
            {%for message in get_flashed_messages() %}

            toastr.error('{{ message }}');

            {% endfor %}

            {%if is_in_registered_time and first_login %}

            toastr.info(' Đã tới giờ đăng ký của bạn');

            {% endif %}

        });
    </script>
</head>

<body>
    <!-- Sticky navbar-->
    <header class="header sticky-top">
        <nav class="navbar navbar-light navbar-expand-md bg-faded justify-content-center">
            <a class="navbar-brand d-flex w-50 mr-auto h1 font-weight-bold white"> Testing Services</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#collapsingNavbar3">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="navbar-collapse collapse w-100" id="collapsingNavbar3">
                <ul class="navbar-nav w-100 justify-content-center">
                    <li class="nav-item active">
                        <button type="button" onclick="autotest_registration()" class='btn blue-background white'> Đi
                            tới đăng ký test
                        </button>
                </ul>
                <ul class="nav navbar-nav ml-auto w-100 justify-content-end">
                    <li class="nav-item pr-3">
                        <a class="nav-link white disabled" >Xin chào {{username}}</a>
                    </li>
                    <li class="nav-item active">
                        <button type="button" onclick="logout()" class='btn blue-background white'> Đăng xuất
                        </button>
                    </li>
                </ul>
            </div>
        </nav>
    </header>

    <section id="tabs">
        <div class="container">
            <nav>
                <div class="nav nav-tabs nav-fill" id="nav-tab" role="tablist">
                    <a class="nav-item nav-link active" id="nav-home-tab" data-toggle="tab" href="#nav-home" role="tab"
                        aria-controls="nav-home" aria-selected="true">Test API</a>
                    <a class="nav-item nav-link" id="nav-profile-tab" data-toggle="tab" href="#nav-profile" role="tab"
                        aria-controls="nav-profile" aria-selected="false">Test Tải</a>
                    <a class="nav-item nav-link" id="nav-contact-tab" data-toggle="tab" href="#nav-contact" role="tab"
                        aria-controls="nav-contact" aria-selected="false">Test Performance</a>
                </div>
            </nav>
            <div class="tab-content py-3 px-3 px-sm-0" id="nav-tabContent">
                <div class="tab-pane fade show active" id="nav-home" role="tabpanel" aria-labelledby="nav-home-tab">
                    <section class="py-1">
                        <div class="container-fluid">
                            <div class="row">
                                <div class="col-sm mx-auto">
                                    <div id="myDIV" class="card py-3">
                                        <div class="container">
                                            <div class="row py-5">
                                                <div class="col">
                                                    <div class="card text-center py-1 border-dark">
                                                        <h2 class = "card-header">eKYC</h2>
                                                        <div class="card-body">
                                                            <div class = "row justify-content-center"> <div class="play_button" id="eKYC"></div></div>
                                                        </div>
                                                        <h5 style="color: green">Đang chạy...</h5>
                                                    </div>
                                                </div>
                                                <div class="col">
                                                    <div class="card text-center py-1 border-dark">
                                                        <h2 class = "card-header">Smart RPA</h2>
                                                        <div class="card-body">
                                                            <div class = "row justify-content-center"> <div class="play_button" id="Smart RPA"></div></div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col">
                                                    <div class="card text-center py-1 border-dark">
                                                        <h2 class = "card-header">iBeta</h2>
                                                        <div class="card-body">
                                                            <div class = "row justify-content-center"> <div class="play_button" id = "iBeta"></div></div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>
                </div>
                <div class="tab-pane fade" id="nav-profile" role="tabpanel" aria-labelledby="nav-profile-tab">
                    <section class="py-3">
                        <div class="container-fluid py-4 text-center">
                            <div class="row">
                                <div class="col-sm mx-auto">
                                    <div id="myDIV" class="card py-3">
                                        <div class="container">
                                            <div class="row pt-5">
                                                <div class="col">
                                                    <button type="button" onclick="load_test_form()"
                                                        class="btn sv_btn btn-sq-responsive">Locust</button>
                                                </div>
                                                <div class="col">
                                                    <button type="button"
                                                        class="btn sv_btn btn-sq-responsive">JMX</button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>
                </div>
                <div class="tab-pane fade" id="nav-contact" role="tabpanel" aria-labelledby="nav-contact-tab">
                    <section class="py-3">
                        <div class="container-fluid py-4 text-center">
                            <div class="col-sm mx-auto">
                                <div id="myDIV" class="card py-3">
                                    <div class="container">
                                        <div class="row pt-5">
                                            <div class="col">
                                                <button type="button" class="btn sv_btn btn-sq-responsive">ETC</button>
                                            </div>
                                            <div class="col">
                                                <button type="button" class="btn sv_btn btn-sq-responsive">ETC</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>
                </div>
            </div>

        </div>
    </section>

    {% for key in api_urls%}
      <tr>
        <td>
          <h3>{{ key }}</h3>
        </td>
        <td>
          <h3>{{ api_urls[key] }}</h3>
        </td>
      </tr>
    {% endfor %}
    <!-- Demo content-->

    <script>
        var urls = {}
        var session_ids = {}
        function load_test_form() {
            location.replace("{{url_for('loadtest_form')}}")
        }

        function autotest_registration() {
            location.replace("{{url_for('autotest')}}")
        }

        function logout() {
            location.replace("{{url_for('logout')}}")
        }

    </script>
</body>

</html>